import{C as t,S as e,i as n,s as i,e as s,k as o,c as a,a as r,n as l,d,b as c,f as m,F as h,H as u,P as p,Q as g,E as f,v as $,r as x,R as v,l as w,B as y,u as D,T as b,U as M,V as I,t as E,g as R,h as P,D as z,G as j,I as C,j as S,m as V,o as k,w as B,N,O,K as W,W as L,x as U,z as X,X as Y,Y as _,Z as T}from"./vendor-38bac64d.js";const A=Symbol("Sorter"),H={idle:"idle",dragging:"dragging"},q=()=>{const e={ready:!1,state:H.idle,wd:null,originWd:null,itemDimension:[0,0],dragIds:new Set,selectedIds:new Set,visibleIdRange:[0,1/0],pos:[0,0],originPos:[0,0]},{subscribe:n,update:i,set:s}=t(e);let o=[];return{subscribe:(...t)=>{const e=n(...t);return()=>{e(),o=[]}},update:i,transit:(t,e)=>i((n=>{if(t===n.state||!Object.values(H).includes(t))return n;if(t===H.dragging){const{dragId:t,originPos:i}=e,{dragIds:s,selectedIds:o}=n;o.has(t)?o.forEach((t=>{s.add(t)})):s.add(t),n.originPos=i,n.state=H.dragging}return t===H.idle&&(n.dragIds.clear(),n.pos=[0,0],n.originPos=[0,0],n.state=H.idle),((t,e)=>{o.forEach((n=>{n.__eventName===e&&n(t)}))})(n,t),n})),dragUntil:(t=10)=>{let e,i=!1;return{promise:new Promise(((s,o)=>{let a;e=n((({pos:e})=>{if(!a)return void(a=[...e]);i&&o();const[n,r]=e,[l,d]=a,c=Math.sqrt(Math.pow(n-l,2)+Math.pow(r-d,2));c>=t&&s(c)}))})).finally((()=>{e()})),abort:()=>{i=!0}}},set:s,on:(t,e)=>{e.__eventName=t,o.push(e)}}},F=(t,e)=>{const n=Math.max(t.left,e.left),i=Math.max(t.top,e.top),s=Math.min(t.right,e.right)-n,o=Math.min(t.bottom,e.bottom)-i;return s<=0||o<=0?new DOMRect(0,0,0,0):new DOMRect(n,i,s,o)},G=(t,e)=>{if(t.dataset.rsScrollContainer||t===document.body)return e;const n=e||t.getBoundingClientRect(),i=t.parentElement;let s;if(i===document.body)s=F(n,new DOMRect(0,0,window.innerWidth,window.innerHeight));else{const t=i.getBoundingClientRect();s=F(n,t)}return G(i,s)};const K={vertical:{name:"vertical",place:({index:t,dimension:e})=>[0,e[1]*t],unplace:({position:t,dimension:e,containerDimension:n,length:i})=>{const s=t[1]-n.top,o=e[1],a=Math.max(Math.ceil(s/o),0),r=Math.min(i,Math.floor((s+n.height)/o)),l=Math.round(s/o);return Math.max(a,Math.min(r,l))},getContainerMaxDimension:({size:t,templateDimension:e})=>{const[n,i]=e;return[n,i*t]},autoScroll:({axis:t,direction:e,scrollPos:n,depth:i})=>{"y"===t&&0!==e?n.start({direction:e,axis:t,depth:i,delta:6}):n.stop()},checkVisibility:({itemDimension:t,wd:e,visibleRect:n})=>{const i=n.y-e.y,s=i+n.height,o=t[1];return[Math.floor(i/o),Math.ceil(s/o)]}},horizontal:{name:"horizontal",place:({index:t,dimension:e})=>[e[0]*t,0],unplace:({position:t,dimension:e,containerDimension:n,scrollPosition:i,length:s})=>{const o=t[0]+i[0],a=e[0],r=i[0],l=Math.ceil(r/a),d=Math.min(s,Math.floor((r+n.width)/a)),c=Math.round(o/a);return Math.max(l,Math.min(d,c))},getContainerMaxDimension:({size:t,templateDimension:e})=>{const[n,i]=e;return[n*t,i]},autoScroll:({axis:t,direction:e,scrollPos:n,depth:i})=>{"x"===t&&0!==e?n.start({direction:e,axis:t,depth:i,delta:6}):n.stop()},checkVisibility:({index:t,itemDimension:e,wd:n,scrollPos:i})=>{const s=e[0],o=i[0],a=t*s,r=(t+1)*s,l=2*e[0],d=o-l,c=o+n.width+l;return r>=d&&r<=c||a<=c&&a>=d}},scanline:{name:"scanline",place:({index:t,containerDimension:e,dimension:n})=>{const i=e.width,[s,o]=n,a=Math.floor(i/s);return[s*(t%a),o*Math.floor(t/a)]},unplace:({position:t,dimension:e,containerDimension:n,scrollPosition:i,length:s})=>{const[o,a]=t,[r,l]=e,{width:d,height:c}=n,m=i[1],h=Math.floor(d/r),u=Math.round(o/r)+h*Math.floor(a/l),p=Math.ceil(m/l)*h,g=Math.min(s,Math.floor((m+c)/l*h));return Math.max(p,Math.min(g,u))},getContainerMaxDimension:(t,e,n)=>{const[i,s]=e,o=n.width,a=Math.floor(o/i);return[o,s*Math.ceil(t/a)]},autoScroll:({axis:t,direction:e,scrollPos:n})=>{"y"===t&&0!==e?n.start({direction:e,axis:t,delta:3}):n.stop()}}};const Q=t=>({isDragging:5&t}),Z=t=>({isDragging:t[2].dragIds.has(t[0])});function J(t){let e,n,i,w,y,D,b=t[8]&&function(t){let e,n,i=t[3].join(" | ")+"";return{c(){e=s("div"),n=E(i),this.h()},l(t){e=a(t,"DIV",{class:!0});var s=r(e);n=R(s,i),s.forEach(d),this.h()},h(){c(e,"class","dev svelte-3wn5jj")},m(t,i){m(t,e,i),h(e,n)},p(t,e){8&e&&i!==(i=t[3].join(" | ")+"")&&P(n,i)},d(t){t&&d(e)}}}(t);const M=t[14].default,I=z(M,t,t[13],Z);return{c(){e=s("div"),b&&b.c(),n=o(),I&&I.c(),this.h()},l(t){e=a(t,"DIV",{class:!0,style:!0});var i=r(e);b&&b.l(i),n=l(i),I&&I.l(i),i.forEach(d),this.h()},h(){c(e,"class","drag-item svelte-3wn5jj"),c(e,"style",i=`\n  width: ${t[2].itemDimension[0]}px;\n  height: ${t[2].itemDimension[1]}px;\n  position: ${t[1]?"fixed":"absolute"};\n  z-index: ${t[1]?"10":"1"};\n  transform: translate(${t[4]}px, ${t[5]}px);\n`)},m(i,s){m(i,e,s),b&&b.m(e,null),h(e,n),I&&I.m(e,null),w=!0,y||(D=[u(e,"mousedown",p(g(t[9])),!0),u(e,"dragstart",p(g(et))),u(e,"drop",g(nt)),u(e,"dragover",g(it))],y=!0)},p(t,n){t[8]&&b.p(t,n),I&&I.p&&(!w||8197&n)&&f(I,M,t,t[13],w?n:-1,Q,Z),(!w||54&n&&i!==(i=`\n  width: ${t[2].itemDimension[0]}px;\n  height: ${t[2].itemDimension[1]}px;\n  position: ${t[1]?"fixed":"absolute"};\n  z-index: ${t[1]?"10":"1"};\n  transform: translate(${t[4]}px, ${t[5]}px);\n`))&&c(e,"style",i)},i(t){w||($(I,t),w=!0)},o(t){x(I,t),w=!1},d(t){t&&d(e),b&&b.d(),I&&I.d(t),y=!1,v(D)}}}function tt(t){let e,n,i=t[2].ready&&J(t);return{c(){i&&i.c(),e=w()},l(t){i&&i.l(t),e=w()},m(t,s){i&&i.m(t,s),m(t,e,s),n=!0},p(t,[n]){t[2].ready?i?(i.p(t,n),4&n&&$(i,1)):(i=J(t),i.c(),$(i,1),i.m(e.parentNode,e)):i&&(y(),x(i,1,1,(()=>{i=null})),D())},i(t){n||($(i),n=!0)},o(t){x(i),n=!1},d(t){i&&i.d(t),t&&d(e)}}}const et=()=>null,nt=()=>null,it=()=>null;function st(t,e,n){let i,s,{$$slots:o={},$$scope:a}=e,{index:r}=e,{draggable:l=!0}=e,d=r,c=null,m=0,h=!1,u=0,p=0;const g=b(null,{stiffness:.1,damping:.4});M(t,g,(t=>n(3,s=t)));const{store:f,dragEnd:$,strategy:x,debug:v}=I(A);M(t,f,(t=>n(2,i=t)));const{place:w}=x,y=t=>{t.stopPropagation(),c&&c(),document.removeEventListener("mouseup",y,!0)},D=t=>{t.stopPropagation(),document.removeEventListener("mouseup",D,!0),$()};return t.$$set=t=>{"index"in t&&n(0,r=t.index),"draggable"in t&&n(10,l=t.draggable),"$$scope"in t&&n(13,a=t.$$scope)},t.$$.update=()=>{var e,o,a,l;if(6149&t.$$.dirty){i.state===H.idle&&n(11,d=r);const t=w({index:d,dimension:i.itemDimension});if(i.dragIds.has(r)){const e=Array.from(i.dragIds).sort(((t,e)=>t-e)).indexOf(r);g.set(((t,e,n,i=0)=>[t[0]+(e[0]-n[0])+10*i,t[1]+(e[1]-n[1])+10*i])(t,i.pos,i.originPos,e))}else{const{dragIds:e}=i;if(e.size!==m){let t=0;e.forEach((e=>{d>e&&t++})),n(11,d-=t),n(12,m=e.size)}g.set(t)}}15&t.$$.dirty&&(n(1,h=i.dragIds.has(r)),n(4,u=h?s[0]+((null==(e=i.wd)?void 0:e.left)-(null==(o=i.originWd)?void 0:o.left)):s[0]),n(5,p=h?s[1]+((null==(a=i.wd)?void 0:a.top)-(null==(l=i.originWd)?void 0:l.top)):s[1]))},[r,h,i,s,u,p,g,f,v,async t=>{if(l&&2!==t.button)try{const{abort:e,promise:n}=f.dragUntil(10);c=e,document.addEventListener("mouseup",y,!0),await n;const{clientX:i,clientY:s}=t;f.transit(H.dragging,{dragId:r,originPos:[i,s]}),document.addEventListener("mouseup",D,!0)}catch(e){return}},l,d,m,a,o]}class ot extends e{constructor(t){super(),n(this,t,st,tt,i,{index:0,draggable:10})}}function at(t){let e,n,i;const o=t[8].default,l=z(o,t,t[7],null),h=l||function(t){let e;return{c(){e=s("div"),this.h()},l(t){e=a(t,"DIV",{class:!0}),r(e).forEach(d),this.h()},h(){c(e,"class","default-indicator "+t[5]+" svelte-1vtxkpd")},m(t,n){m(t,e,n)},p:j,d(t){t&&d(e)}}}(t);return{c(){e=s("div"),h&&h.c(),this.h()},l(t){e=a(t,"DIV",{class:!0,style:!0});var n=r(e);h&&h.l(n),n.forEach(d),this.h()},h(){c(e,"class","indicator-wrapper svelte-1vtxkpd"),c(e,"style",n=`\n    width: ${t[0].itemDimension[0]}px;\n    height: ${t[0].itemDimension[1]}px;\n    transform: translate(${t[1][0]}px, ${t[1][1]}px);\n    opacity: ${t[2]};\n`)},m(t,n){m(t,e,n),h&&h.m(e,null),i=!0},p(t,[s]){l&&l.p&&(!i||128&s)&&f(l,o,t,t[7],i?s:-1,null,null),(!i||7&s&&n!==(n=`\n    width: ${t[0].itemDimension[0]}px;\n    height: ${t[0].itemDimension[1]}px;\n    transform: translate(${t[1][0]}px, ${t[1][1]}px);\n    opacity: ${t[2]};\n`))&&c(e,"style",n)},i(t){i||($(h,t),i=!0)},o(t){x(h,t),i=!1},d(t){t&&d(e),h&&h.d(t)}}}function rt(t,e,n){let i,s,o,a,{$$slots:r={},$$scope:l}=e;const{store:d,dropIndex:c,strategy:m}=I(A);M(t,d,(t=>n(0,a=t))),M(t,c,(t=>n(6,o=t)));const{name:h="",place:u}=m;return t.$$set=t=>{"$$scope"in t&&n(7,l=t.$$scope)},t.$$.update=()=>{65&t.$$.dirty&&n(1,i=u({index:o,dimension:a.itemDimension})),1&t.$$.dirty&&n(2,s="dragging"===a.state?1:0)},[a,i,s,d,c,h,o,l,r]}class lt extends e{constructor(t){super(),n(this,t,rt,at,i,{})}}const{window:dt}=_,ct=t=>({}),mt=t=>({});function ht(t,e,n){const i=t.slice();return i[25]=e[n],i[27]=n,i}const ut=t=>({item:4&t,index:4&t}),pt=t=>({item:t[25],index:t[27]});function gt(t){let e,n,i,p,g,f,$,x,v,w,y=t[5].visibleIdRange.join(" -> ")+"";return{c(){e=s("button"),n=E("Recalculate scroll pos"),i=o(),p=s("pre"),g=E("dropIndex: "),f=E(t[6]),$=E("\nvisiblerange: "),x=E(y),this.h()},l(s){e=a(s,"BUTTON",{class:!0});var o=r(e);n=R(o,"Recalculate scroll pos"),o.forEach(d),i=l(s),p=a(s,"PRE",{style:!0});var c=r(p);g=R(c,"dropIndex: "),f=R(c,t[6]),$=R(c,"\nvisiblerange: "),x=R(c,y),c.forEach(d),this.h()},h(){c(e,"class","debug-recalc svelte-1i47mn4"),C(p,"position","fixed"),C(p,"bottom","0.5rem"),C(p,"left","0.5rem")},m(s,o){m(s,e,o),h(e,n),m(s,i,o),m(s,p,o),h(p,g),h(p,f),h(p,$),h(p,x),v||(w=u(e,"click",t[11]),v=!0)},p(t,e){64&e&&P(f,t[6]),32&e&&y!==(y=t[5].visibleIdRange.join(" -> ")+"")&&P(x,y)},d(t){t&&d(e),t&&d(i),t&&d(p),v=!1,w()}}}function ft(t){let e,n;return e=new ot({props:{index:t[27],$$slots:{default:[$t]},$$scope:{ctx:t}}}),{c(){S(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,i){k(e,t,i),n=!0},p(t,n){const i={};4&n&&(i.index=t[27]),262148&n&&(i.$$scope={dirty:n,ctx:t}),e.$set(i)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){x(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}function $t(t){let e;const n=t[16].item,i=z(n,t,t[18],pt);return{c(){i&&i.c()},l(t){i&&i.l(t)},m(t,n){i&&i.m(t,n),e=!0},p(t,s){i&&i.p&&(!e||262148&s)&&f(i,n,t,t[18],e?s:-1,ut,pt)},i(t){e||($(i,t),e=!0)},o(t){x(i,t),e=!1},d(t){i&&i.d(t)}}}function xt(t,e){let n,i,s,o=e[9](e[27],e[5]),a=o&&ft(e);return{key:t,first:null,c(){n=w(),a&&a.c(),i=w(),this.h()},l(t){n=w(),a&&a.l(t),i=w(),this.h()},h(){this.first=n},m(t,e){m(t,n,e),a&&a.m(t,e),m(t,i,e),s=!0},p(t,n){e=t,36&n&&(o=e[9](e[27],e[5])),o?a?(a.p(e,n),36&n&&$(a,1)):(a=ft(e),a.c(),$(a,1),a.m(i.parentNode,i)):a&&(y(),x(a,1,1,(()=>{a=null})),D())},i(t){s||($(a),s=!0)},o(t){x(a),s=!1},d(t){t&&d(n),a&&a.d(t),t&&d(i)}}}function vt(t){let e,n,i,p,g,w,b,M=[],I=new Map,E=t[1]&&t[5].ready&&gt(t),R=t[2];const P=t=>t[25].id;for(let s=0;s<R.length;s+=1){let e=ht(t,R,s),n=P(e);I.set(n,M[s]=xt(n,e))}const j=t[16].indicator,W=z(j,t,t[18],mt),L=W||function(t){let e,n;return e=new lt({}),{c(){S(e.$$.fragment)},l(t){V(e.$$.fragment,t)},m(t,i){k(e,t,i),n=!0},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){x(e.$$.fragment,t),n=!1},d(t){B(e,t)}}}();return{c(){E&&E.c(),e=o(),n=s("div");for(let t=0;t<M.length;t+=1)M[t].c();i=o(),L&&L.c(),this.h()},l(t){E&&E.l(t),e=l(t),n=a(t,"DIV",{class:!0,style:!0});var s=r(n);for(let e=0;e<M.length;e+=1)M[e].l(s);i=l(s),L&&L.l(s),s.forEach(d),this.h()},h(){c(n,"class",p="inner-wrapper "+t[3]+" svelte-1i47mn4"),C(n,"width",t[4][0]+"px"),C(n,"height",t[4][1]+"px")},m(s,o){E&&E.m(s,o),m(s,e,o),m(s,n,o);for(let t=0;t<M.length;t+=1)M[t].m(n,null);h(n,i),L&&L.m(n,null),t[17](n),g=!0,w||(b=[u(dt,"mousemove",t[10]),u(dt,"scroll",t[12],!0)],w=!0)},p(t,[s]){t[1]&&t[5].ready?E?E.p(t,s):(E=gt(t),E.c(),E.m(e.parentNode,e)):E&&(E.d(1),E=null),262692&s&&(R=t[2],y(),M=N(M,s,P,1,t,R,I,n,O,xt,i,ht),D()),W&&W.p&&(!g||262144&s)&&f(W,j,t,t[18],g?s:-1,ct,mt),(!g||8&s&&p!==(p="inner-wrapper "+t[3]+" svelte-1i47mn4"))&&c(n,"class",p),(!g||16&s)&&C(n,"width",t[4][0]+"px"),(!g||16&s)&&C(n,"height",t[4][1]+"px")},i(t){if(!g){for(let t=0;t<R.length;t+=1)$(M[t]);$(L,t),g=!0}},o(t){for(let e=0;e<M.length;e+=1)x(M[e]);x(L,t),g=!1},d(i){E&&E.d(i),i&&d(e),i&&d(n);for(let t=0;t<M.length;t+=1)M[t].d();L&&L.d(i),t[17](null),w=!1,v(b)}}}function wt(t,e,n){let i,s,{$$slots:o={},$$scope:a}=e;const r=W();let{itemDimension:l=[0,0]}=e,{debug:d=!1}=e,{data:c=[]}=e,{selected:m=[]}=e,{class:h=""}=e,{strategy:u="vertical"}=e;const p="string"==typeof u?K[u]:u,{unplace:g,getContainerMaxDimension:f,checkVisibility:$}=p;let{ref:x}=e;const v=q();M(t,v,(t=>n(5,i=t)));const w=L(v,(t=>t.dragIds.size>0?g({position:t.pos,dimension:t.itemDimension,containerDimension:t.wd,length:c.length}):null));M(t,w,(t=>n(6,s=t)));let y;U(A,{store:v,dragEnd:()=>{const{dragIds:t}=i;r("dragend",{cancelled:!1,dropIndex:s,dragIds:Array.from(t).sort(((t,e)=>t-e))}),v.transit(H.idle)},dropIndex:w,debug:d,strategy:p}),X((()=>{const t=x.getBoundingClientRect();Y(v,i.wd=t,i),Y(v,i.originWd={top:t.top+window.scrollY,left:t.left+window.scrollX},i),Y(v,i.itemDimension=l,i),Y(v,i.ready=!0,i)}));const D=()=>{const t=x.getBoundingClientRect();return Y(v,i.wd=t,i),t};return v.on("dragging",(()=>D())),t.$$set=t=>{"itemDimension"in t&&n(13,l=t.itemDimension),"debug"in t&&n(1,d=t.debug),"data"in t&&n(2,c=t.data),"selected"in t&&n(14,m=t.selected),"class"in t&&n(3,h=t.class),"strategy"in t&&n(15,u=t.strategy),"ref"in t&&n(0,x=t.ref),"$$scope"in t&&n(18,a=t.$$scope)},t.$$.update=()=>{if(8196&t.$$.dirty&&n(4,y=f({size:c.length,templateDimension:l})),8192&t.$$.dirty&&Y(v,i.itemDimension=l,i),16388&t.$$.dirty){let t=new Set;m.forEach((e=>{const n=c.findIndex((t=>t.id===e));t.add(n)})),Y(v,i.selectedIds=t,i)}},[x,d,c,h,y,i,s,v,w,(t,e)=>{const{ready:n,dragIds:i,selectedIds:s,visibleIdRange:o}=e;return n&&(i.has(t)||s.has(t)||t<=o[1]+s.size&&t>=o[0])},t=>{const{clientX:e,clientY:n}=t;Y(v,i.pos=[e,n],i)},D,()=>{const t=x.getBoundingClientRect(),e=G(x,t),{itemDimension:n}=i;Y(v,i.wd=t,i),Y(v,i.visibleIdRange=$({wd:t,itemDimension:n,visibleRect:e}),i)},l,m,u,o,function(t){T[t?"unshift":"push"]((()=>{x=t,n(0,x)}))},a]}class yt extends e{constructor(t){super(),n(this,t,wt,vt,i,{itemDimension:13,debug:1,data:2,selected:14,class:3,strategy:15,ref:0})}}const Dt=(t,e,n)=>{const i=((t,e)=>{const n=e.filter((e=>e<t.length&&e>=0)),i=n.slice().sort(((t,e)=>t-e)).reduce(((e,n,i)=>(e[n]=t.splice(n-i,1)[0],e)),{});return n.map((t=>i[t]))})(t,e);return t.splice(n,0,...i),t};export{yt as D,lt as a,ot as b,Dt as r};
